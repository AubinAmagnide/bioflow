---
title: "Single Trial Analysis Report"
author: "Contact:<a href = 'https://github.com/Breeding-Analytics/bioflow' target = '_blank'>Breeding Analytics Team, OneCGIAR</a> breedinganalytics@cgiar.org"
date: "April 24, 2024"  
output: html_document
params:
 toDownload: FALSE
---







### Entries and traits by environment table

The following table allows to see which locations had data for the different traits.

<p>&nbsp;</p>

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; "><table class="table table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> environment </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> YLDTONHA </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> HT_AVG </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> FLW50 </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> YLD_TON </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> ZINC </th>
   <th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> PERCENT_HEAD_RICE </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> Number of entries </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> TMeLS-R (Drt)_Stage 1_2022_Wet_IN_CT_RP_IGKV </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> 235 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> TMeLS-R (Drt)_Stage 1_2022_Wet_IN_JH_RN_BAU </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> 235 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> TMeLS-R (Drt)_Stage 1_2022_Wet_IN_TR_WT_ICAR </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> 235 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> TMeLS-R (Drt)_Stage 1_2022_Wet_IN_UP_PY_SHUATS </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:right;"> 235 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> TMeLS-R (Drt)_Stage 1_2022_Wet_IN_WB_PU_ZDRPRS </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> 234 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> TMeLS-R_Stage 1_2023_Wet_IN_CT_RP_IGKV </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> 188 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> TMeLS-R_Stage 1_2023_Wet_IN_JH_HZ_CRURRS </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> 188 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> TMeLS-R_Stage 1_2023_Wet_IN_JH_RN_BAU </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> 187 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> TMeLS-R_Stage 1_2023_Wet_IN_UP_PY_SHUATS </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> 188 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> TMeLS-R_Stage 1_2023_Wet_IN_WB_PU_ZDRPRS </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;"> ✅ </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:left;">  </td>
   <td style="text-align:right;"> 188 </td>
  </tr>
</tbody>
</table></div>

<p>&nbsp;</p>

### Summary statistics

The following table allows you to verify different quality metrics (KPIs) for the different environments. The selector button allows you to filter by trait.

<p>&nbsp;</p>

<!--html_preserve--><div class="form-group shiny-input-container">
<label class="control-label" id="reportBuilder_1-traitSta-label" for="reportBuilder_1-traitSta">Trait:</label>
<div>
<select id="reportBuilder_1-traitSta" class="shiny-input-select"><option value="YLD_TON" selected>YLD_TON</option>
<option value="YLDTONHA">YLDTONHA</option>
<option value="FLW50">FLW50</option>
<option value="HT_AVG">HT_AVG</option>
<option value="ZINC">ZINC</option>
<option value="PERCENT_HEAD_RICE">PERCENT_HEAD_RICE</option></select>
<script type="application/json" data-for="reportBuilder_1-traitSta" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div><!--/html_preserve-->

Table of statistics:

<!--html_preserve--><div class="datatables html-widget html-widget-output shiny-report-size html-fill-item" id="reportBuilder_1-out5e3aa1f767d1b0df" style="width:100%;height:auto;"></div><!--/html_preserve-->

Variance components ratios per environment 

<p>&nbsp;</p>

<!--html_preserve--><div class="form-group shiny-input-container">
<label class="control-label" id="reportBuilder_1-traitSta0-label" for="reportBuilder_1-traitSta0">Trait:</label>
<div>
<select id="reportBuilder_1-traitSta0" class="shiny-input-select"><option value="YLD_TON" selected>YLD_TON</option>
<option value="YLDTONHA">YLDTONHA</option>
<option value="FLW50">FLW50</option>
<option value="HT_AVG">HT_AVG</option>
<option value="ZINC">ZINC</option>
<option value="PERCENT_HEAD_RICE">PERCENT_HEAD_RICE</option></select>
<script type="application/json" data-for="reportBuilder_1-traitSta0" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div><!--/html_preserve-->

<!--html_preserve--><div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item" id="reportBuilder_1-out82d3e6252a53376a" style="width:100%;height:400px;"></div><!--/html_preserve-->

<p>&nbsp;</p>

<!--html_preserve--><div class="form-group shiny-input-container">
<label class="control-label" id="reportBuilder_1-parameterMetrics-label" for="reportBuilder_1-parameterMetrics">Parameter:</label>
<div>
<select id="reportBuilder_1-parameterMetrics" class="shiny-input-select"><option value="plotH2" selected>plotH2</option>
<option value="CV" selected>CV</option>
<option value="r2" selected>r2</option>
<option value="mean" selected>mean</option></select>
<script type="application/json" data-for="reportBuilder_1-parameterMetrics" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div><!--/html_preserve-->

Barplot for parameter values

<!--html_preserve--><div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item" id="reportBuilder_1-outccb82654117e2b5c" style="width:100%;height:400px;"></div><!--/html_preserve-->

<p>&nbsp;</p>

### Field view

The following graphs allow the user to inspect the spatial trends in the different fields.


<!--html_preserve--><div class="form-group shiny-input-container">
<label class="control-label" id="reportBuilder_1-traitStaFieldView-label" for="reportBuilder_1-traitStaFieldView">Trait:</label>
<div>
<select id="reportBuilder_1-traitStaFieldView" class="shiny-input-select"><option value="YLDTONHA" selected>YLDTONHA</option>
<option value="HT_AVG">HT_AVG</option>
<option value="FLW50">FLW50</option>
<option value="YLD_TON">YLD_TON</option>
<option value="ZINC">ZINC</option>
<option value="PERCENT_HEAD_RICE">PERCENT_HEAD_RICE</option></select>
<script type="application/json" data-for="reportBuilder_1-traitStaFieldView" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div><!--/html_preserve-->

<!--html_preserve--><div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item" id="reportBuilder_1-outdce5abc6827d498c" style="width:100%;height:400px;"></div><!--/html_preserve-->

### Predictions

The following table allows you to check the trait predictions in wide format and filter them by environment.

<p>&nbsp;</p>

<!--html_preserve--><div class="form-group shiny-input-container">
<label class="control-label" id="reportBuilder_1-envSta-label" for="reportBuilder_1-envSta">Environment:</label>
<div>
<select id="reportBuilder_1-envSta" class="shiny-input-select"><option value="TMeLS-R_Stage 1_2023_Wet_IN_JH_HZ_CRURRS" selected>TMeLS-R_Stage 1_2023_Wet_IN_JH_HZ_CRURRS</option>
<option value="TMeLS-R_Stage 1_2023_Wet_IN_JH_RN_BAU">TMeLS-R_Stage 1_2023_Wet_IN_JH_RN_BAU</option>
<option value="TMeLS-R_Stage 1_2023_Wet_IN_WB_PU_ZDRPRS">TMeLS-R_Stage 1_2023_Wet_IN_WB_PU_ZDRPRS</option>
<option value="TMeLS-R (Drt)_Stage 1_2022_Wet_IN_CT_RP_IGKV">TMeLS-R (Drt)_Stage 1_2022_Wet_IN_CT_RP_IGKV</option>
<option value="TMeLS-R (Drt)_Stage 1_2022_Wet_IN_UP_PY_SHUATS">TMeLS-R (Drt)_Stage 1_2022_Wet_IN_UP_PY_SHUATS</option>
<option value="TMeLS-R (Drt)_Stage 1_2022_Wet_IN_JH_RN_BAU">TMeLS-R (Drt)_Stage 1_2022_Wet_IN_JH_RN_BAU</option>
<option value="TMeLS-R (Drt)_Stage 1_2022_Wet_IN_TR_WT_ICAR">TMeLS-R (Drt)_Stage 1_2022_Wet_IN_TR_WT_ICAR</option>
<option value="TMeLS-R (Drt)_Stage 1_2022_Wet_IN_WB_PU_ZDRPRS">TMeLS-R (Drt)_Stage 1_2022_Wet_IN_WB_PU_ZDRPRS</option>
<option value="TMeLS-R_Stage 1_2023_Wet_IN_CT_RP_IGKV">TMeLS-R_Stage 1_2023_Wet_IN_CT_RP_IGKV</option>
<option value="TMeLS-R_Stage 1_2023_Wet_IN_UP_PY_SHUATS">TMeLS-R_Stage 1_2023_Wet_IN_UP_PY_SHUATS</option></select>
<script type="application/json" data-for="reportBuilder_1-envSta" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div><!--/html_preserve-->


<!--html_preserve--><div class="datatables html-widget html-widget-output shiny-report-size html-fill-item" id="reportBuilder_1-outd5187a425ffb1776" style="width:100%;height:auto;"></div><!--/html_preserve-->

<p>&nbsp;</p>

The following boxplot allows you to see the distribution of predicted values by trait (y-axis) in the different environments.

<p>&nbsp;</p>

<!--html_preserve--><div class="form-group shiny-input-container">
<label class="control-label" id="reportBuilder_1-traitStaBox-label" for="reportBuilder_1-traitStaBox">Trait:</label>
<div>
<select id="reportBuilder_1-traitStaBox" class="shiny-input-select"><option value="YLD_TON" selected>YLD_TON</option>
<option value="YLDTONHA" selected>YLDTONHA</option>
<option value="FLW50" selected>FLW50</option>
<option value="HT_AVG" selected>HT_AVG</option>
<option value="ZINC" selected>ZINC</option>
<option value="PERCENT_HEAD_RICE" selected>PERCENT_HEAD_RICE</option></select>
<script type="application/json" data-for="reportBuilder_1-traitStaBox" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div><!--/html_preserve-->

<!--html_preserve--><div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item" id="reportBuilder_1-out285c9482b8403d48" style="width:100%;height:400px;"></div><!--/html_preserve-->

<p>&nbsp;</p>

### Correlation between environments

The following plot aims to show the correlation between BLUEs or BLUPs (depending on the parameter settings) among the different environments.

<p>&nbsp;</p>

<!--html_preserve--><div class="form-group shiny-input-container">
<label class="control-label" id="reportBuilder_1-traitStaCor-label" for="reportBuilder_1-traitStaCor">Trait:</label>
<div>
<select id="reportBuilder_1-traitStaCor" class="shiny-input-select"><option value="YLD_TON" selected>YLD_TON</option>
<option value="YLDTONHA" selected>YLDTONHA</option>
<option value="FLW50" selected>FLW50</option>
<option value="HT_AVG" selected>HT_AVG</option>
<option value="ZINC" selected>ZINC</option>
<option value="PERCENT_HEAD_RICE" selected>PERCENT_HEAD_RICE</option></select>
<script type="application/json" data-for="reportBuilder_1-traitStaCor" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div><!--/html_preserve-->


<!--html_preserve--><div class="plotly html-widget html-widget-output shiny-report-size shiny-report-theme html-fill-item" id="reportBuilder_1-out67ea818502a63461" style="width:100%;height:400px;"></div><!--/html_preserve-->


### References of methods used

Velazco, J. G., Rodriguez-Alvarez, M. X., Boer, M. P., Jordan, D. R., Eilers, P. H., Malosetti, M., & Van Eeuwijk, F. A. (2017). Modelling spatial trends in sorghum breeding field trials using a two-dimensional P-spline mixed model. Theoretical and Applied Genetics, 130, 1375-1392.

Rodriguez-Alvarez, M. X., Boer, M. P., van Eeuwijk, F. A., & Eilers, P. H. (2018). Correcting for spatial heterogeneity in plant breeding experiments with P-splines. Spatial Statistics, 23, 52-71.

R Core Team (2021). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.

Boer M, van Rossum B (2022). LMMsolver: Linear Mixed Model Solver. R package version 1.0.4.9000.

<p>&nbsp;</p>

